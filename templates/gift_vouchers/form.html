{% extends 'base.html' %}
{% load i18n %}
{% load honeypot %}

{% block title %}{% trans "Gift Voucher" %}{% endblock %}

{% block meta_description %}{% trans "Purchase a gift voucher for a loved one. Choose from our range of facial treatments." %}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-12">
    <div class="max-w-2xl mx-auto">
        <h1 class="text-4xl font-bold mb-8 text-[#593d09] text-center">{% trans "Gift Voucher" %}</h1>
        
        <form method="post" class="bg-white p-8 rounded-lg shadow-md">
            {% csrf_token %}
            {% render_honeypot_field %}
            
            <!-- Treatment Selection -->
            <div class="mb-6">
                <label for="treatment" class="block mb-2 font-bold text-[#593d09]">{% trans "Select a treatment" %} *</label>
                <select id="treatment" name="treatment" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    <option value="">{% trans "-- Select Treatment --" %}</option>
                    {% for treatment in treatments %}
                    <option value="{{ treatment.id }}">{{ treatment.get_title }} - {{ treatment.price }} â‚¬</option>
                    {% endfor %}
                </select>
            </div>
            
            <!-- Email Delivery Option -->
            <div class="mb-6">
                <label class="block mb-2 font-bold text-[#593d09]">{% trans "Confirmation of purchase will be sent to this email address" %} *</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="radio" name="email_option" value="purchaser" required class="mr-2">
                        <span class="text-[#593d09]">{% trans "Send the gift voucher to my email address" %}</span>
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="email_option" value="recipient" class="mr-2">
                        <span class="text-[#593d09]">{% trans "Send the gift voucher to recipient's email address" %}</span>
                    </label>
                </div>
            </div>
            
            <!-- Gift Voucher Details -->
            <div class="mb-6">
                <h3 class="text-xl font-bold mb-4 text-[#593d09]">{% trans "Gift voucher details" %}</h3>
                <div class="space-y-4">
                    <div>
                        <label for="recipient_name" class="block mb-2 font-bold text-[#593d09]">{% trans "Recipient name" %} *</label>
                        <input type="text" id="recipient_name" name="recipient_name" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                    <div>
                        <label for="personalised_message" class="block mb-2 font-bold text-[#593d09]">{% trans "Personalised message" %}</label>
                        <textarea id="personalised_message" name="personalised_message" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]"></textarea>
                    </div>
                    <div>
                        <label for="from_name" class="block mb-2 font-bold text-[#593d09]">{% trans "Who is this gift from?" %} *</label>
                        <input type="text" id="from_name" name="from_name" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                    <div id="recipient_email_field" class="hidden">
                        <label for="recipient_email" class="block mb-2 font-bold text-[#593d09]">{% trans "Recipient email address" %} *</label>
                        <input type="email" id="recipient_email" name="recipient_email" class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                </div>
            </div>
            
            <!-- Purchaser Details -->
            <div class="mb-6">
                <h3 class="text-xl font-bold mb-4 text-[#593d09]">{% trans "Purchaser details" %}</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="purchaser_first_name" class="block mb-2 font-bold text-[#593d09]">{% trans "First name" %} *</label>
                        <input type="text" id="purchaser_first_name" name="purchaser_first_name" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                    <div>
                        <label for="purchaser_last_name" class="block mb-2 font-bold text-[#593d09]">{% trans "Last name" %} *</label>
                        <input type="text" id="purchaser_last_name" name="purchaser_last_name" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="purchaser_email" class="block mb-2 font-bold text-[#593d09]">{% trans "Email address" %} *</label>
                        <input type="email" id="purchaser_email" name="purchaser_email" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                    <div>
                        <label for="purchaser_mobile" class="block mb-2 font-bold text-[#593d09]">{% trans "Mobile number" %} *</label>
                        <input type="tel" id="purchaser_mobile" name="purchaser_mobile" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-[#593d09]">
                    </div>
                </div>
            </div>
            
            <button type="submit" class="w-full bg-[#593d09] text-white px-6 py-3 rounded hover:bg-[#4a3207] transition-colors font-bold">
                {% trans "Submit Order" %}
            </button>
        </form>
    </div>
</div>

<script>
    // Show/hide recipient email field based on radio selection
    document.querySelectorAll('input[name="email_option"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const recipientEmailField = document.getElementById('recipient_email_field');
            const recipientEmailInput = document.getElementById('recipient_email');
            if (this.value === 'recipient') {
                recipientEmailField.classList.remove('hidden');
                recipientEmailInput.required = true;
            } else {
                recipientEmailField.classList.add('hidden');
                recipientEmailInput.required = false;
            }
        });
    });
</script>
{% endblock %}

